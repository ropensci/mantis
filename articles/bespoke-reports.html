<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating bespoke reports • mantis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating bespoke reports">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mantis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mantis.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bespoke-reports.html">Creating bespoke reports</a></li>
    <li><a class="dropdown-item" href="../articles/alert-rules.html">Specifying alerting rules</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-example-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Example reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-example-reports">
<li><a class="dropdown-item" href="../articles/example-report-interactive.html">Interactive report</a></li>
    <li><a class="dropdown-item" href="../articles/example-report-static-heatmap.html">Heatmap report</a></li>
    <li><a class="dropdown-item" href="../articles/example-report-static-multipanel.html">Multipanel report</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/mantis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creating bespoke reports</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/mantis/blob/main/vignettes/bespoke-reports.Rmd" class="external-link"><code>vignettes/bespoke-reports.Rmd</code></a></small>
      <div class="d-none name"><code>bespoke-reports.Rmd</code></div>
    </div>

    
    
<p>This vignette introduces the essentials of how to add visualisations
from the <code>mantis</code> package into your own bespoke html reports.
It will be assumed that you already know how to generate html documents
from a Rmd file, including creating tabsets. If you don’t, take a look
at the official documentation and/or the many other online resources
available before proceeding.</p>
<p>Note: Currently, <code>mantis</code> uses <code>rmarkdown</code> to
generate its content and reports, and so the visualisations may not
render as expected if added to a Quarto report. In future there will be
more support for generating/adding to Quarto reports.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The standard <code><a href="../reference/mantis_report.html">mantis_report()</a></code> is designed for quick and
simple review of time series that can be stored in a single data frame.
If you like the <code>mantis</code> visualisations but want to build a
more complex report, e.g. to display data from multiple data frames,
display <code>mantis</code> content alongside other
(non-<code>mantis</code>) content, or to add your own branding, you can
create your own html report using existing <code>rmarkdown</code>
functionality, and then insert <code>mantis</code> content and/or tabs
into your report as desired.</p>
<p>The easiest way to get started with this is to clone the <a href="https://github.com/phuongquan/mantis-templates" class="external-link">mantis-templates</a>
project to see it in action, then choose a template Rmd file that you
can copy from/adapt.</p>
</div>
<div class="section level2">
<h2 id="adding-mantis-content">Adding <code>mantis</code> content<a class="anchor" aria-label="anchor" href="#adding-mantis-content"></a>
</h2>
<p><code>mantis</code> includes one main function
<code><a href="../reference/bespoke_rmd_output.html">bespoke_rmd_output()</a></code> for creating content for bespoke
reports. This function use side-effects to generate the desired
markdown, and must be placed inside a <code>{r, results='asis'}</code>
chunk.</p>
<p>The function can:</p>
<ul>
<li><p>add a single visualisation, with or without creating the
container tab, or</p></li>
<li><p>add a set of tabs, each based on the same output specification,
with or without creating the parent tab.</p></li>
</ul>
<p>The function also includes a few additional parameters not available
in the standard <code><a href="../reference/mantis_report.html">mantis_report()</a></code> to allow some extra control
over the display.</p>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>```{r, results='asis'}</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a># create a parent tab with a set of child tabs</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>mantis::bespoke_rmd_output(</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  df = mantis::example_prescription_numbers,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  inputspec = mantis::inputspec(</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    timepoint_col = "PrescriptionDate",</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    item_cols = c("Location", "Antibiotic"),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    value_col = "NumberOfPrescriptions",</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    tab_col = "Location"</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  ),</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  outputspec = mantis::outputspec_interactive(</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    plot_value_type = "value",</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    plot_type = "bar",</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    item_labels = c("Antibiotic" = "Antibiotic name"),</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    plot_label = "Prescriptions over time",</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    sync_axis_range = FALSE,</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    item_order = list("Location" = c("SITE3", "SITE2", "SITE1"))</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  ),</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  timepoint_limits = c(NA, Sys.Date()),</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  fill_with_zero = FALSE,</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  tab_name = "Group of child tabs",</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  tab_level = 1</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>```</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extra-requirements-for-interactive-reports">Extra requirements for interactive reports<a class="anchor" aria-label="anchor" href="#extra-requirements-for-interactive-reports"></a>
</h2>
<p>Due to complexities in the way <code>dygraphs</code> widgets are
rendered, there are two additional chunks that must be included in the
Rmd file, otherwise the graphs can disappear unexpectedly.</p>
<p>Firstly, add the following chunk to the Rmd file to ensure the
<code>dygraphs</code> plots are initialised. Remember to set the same
<code>plot_type</code> as the one you are using for the rest of the
report. This is best placed at the bottom of the file as it can lead to
an extra line space. Note: unlike when creating <code>mantis</code>
content, this chunk should <em>not</em> include
<code>results='asis'</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>```{r}</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a># this chunk is necessary when using mantis::outputspec_interactive().</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a># it ensures that the dygraphs render when built using `cat()`</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a># set the plot_type to the same plot_type as the real output</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>mantis::bespoke_rmd_initialise_widgets(plot_type = "bar")</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>```</span></code></pre></div>
<p>Secondly, when the browser window is resized, all
<code>dygraphs</code> plots on inactive tabs disappear. A workaround for
this is to redraw them all by reloading the page. To do this, add the
following chunk at the top of the Rmd file.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>```{js}</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>// this chunk is necessary when using mantis::outputspec_interactive(). </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>// when the browser window is resized, all dygraphs on inactive tabs disappear. Reload page to </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>// redraw them all.</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>window.onresize = function(){ location.reload(); }</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>```</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by T. Phuong Quan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
