<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Specifying alerting rules • mantis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specifying alerting rules">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mantis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mantis.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bespoke-reports.html">Creating bespoke reports</a></li>
    <li><a class="dropdown-item" href="../articles/alert-rules.html">Specifying alerting rules</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-example-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Example reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-example-reports">
<li><a class="dropdown-item" href="../articles/example-report-interactive.html">Interactive report</a></li>
    <li><a class="dropdown-item" href="../articles/example-report-static-heatmap.html">Heatmap report</a></li>
    <li><a class="dropdown-item" href="../articles/example-report-static-multipanel.html">Multipanel report</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/mantis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Specifying alerting rules</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/mantis/blob/main/vignettes/alert-rules.Rmd" class="external-link"><code>vignettes/alert-rules.Rmd</code></a></small>
      <div class="d-none name"><code>alert-rules.Rmd</code></div>
    </div>

    
    
<p>While visual inspection is probably the most reliable way of
identifying anomalies in time series, things can be missed when there
are large numbers of time series to inspect. In this case, it can be
useful to additionally test the individual time series for certain
conditions, such as the presence of missing values or for values
breaching pre-set limits, and to alert the user to them.</p>
<p>The alert results are displayed in different ways depending on the
chosen type of output. Tabs containing time series which failed at least
one alert are highlighted. A separate tab containing all the alert
results is added at the end.</p>
<p>It is also possible to just generate the alert results as a data
frame.</p>
<p>Note: This functionality is still in the early stages of development,
and can increase the document size and rendering time of the report
considerably.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>One or more alerting rules can be specified within an
<code><a href="../reference/alert_rules.html">alert_rules()</a></code> object, which is then passed into the
<code>alert_rules</code> parameter. When creating a standard mantis
report, the <code>alertspec</code> parameter also controls how the
results are displayed in the final tab.</p>
</div>
<div class="section level2">
<h2 id="built-in-rules">Built-in rules<a class="anchor" aria-label="anchor" href="#built-in-rules"></a>
</h2>
<p>There are a number of built-in rules that can be used to test for
simple conditions, the simplest of which is testing for the presence of
missing values. The <code>extent_type</code> and
<code>extent_value</code> parameters can be used to adjust the
tolerance. E.g.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># alert if all values are NA</span></span>
<span><span class="va">ars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alert_rules.html">alert_rules</a></span><span class="op">(</span><span class="fu"><a href="../reference/alert_rule_types.html">alert_missing</a></span><span class="op">(</span>extent_type <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># alert if there are 10 or more missing values in total</span></span>
<span><span class="co"># or if the last 3 or more values are missing</span></span>
<span><span class="co"># or if 5 or more values in a row are missing</span></span>
<span><span class="va">ars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alert_rules.html">alert_rules</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_missing</a></span><span class="op">(</span>extent_type <span class="op">=</span> <span class="st">"any"</span>, extent_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_missing</a></span><span class="op">(</span>extent_type <span class="op">=</span> <span class="st">"last"</span>, extent_value <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_missing</a></span><span class="op">(</span>extent_type <span class="op">=</span> <span class="st">"consecutive"</span>, extent_value <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/alert_rule_types.html">alert_equals()</a></code>, <code><a href="../reference/alert_rule_types.html">alert_below()</a></code>,
<code><a href="../reference/alert_rule_types.html">alert_above()</a></code> rules work similarly, but with an extra
parameter <code>rule_value</code> to compare against. It is also
possible to compare a range of values with another range of values using
the <code><a href="../reference/alert_rule_types.html">alert_difference_above_perc()</a></code> and
<code><a href="../reference/alert_rule_types.html">alert_difference_below_perc()</a></code> rules. This can be useful for
checking if recent values are lower/higher than in a previous period,
over a particular percentage. This comparison is based on the mean of
values in the two periods. The ranges should be contiguous, and denote
positions from the end of the time series. E.g.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># alert if the mean of last 3 values is more than 20% higher than</span></span>
<span><span class="co"># the mean of the preceding 12 values</span></span>
<span><span class="va">ars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alert_rules.html">alert_rules</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_difference_above_perc</a></span><span class="op">(</span></span>
<span>    current_period <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>    previous_period <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">15</span>,</span>
<span>    rule_value <span class="op">=</span> <span class="fl">20</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="custom-rules">Custom rules<a class="anchor" aria-label="anchor" href="#custom-rules"></a>
</h2>
<p>If you want to apply a more complex rule, you can specify your own
using <code><a href="../reference/alert_rule_types.html">alert_custom()</a></code>. E.g.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alert_rules.html">alert_rules</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_custom</a></span><span class="op">(</span></span>
<span>    short_name <span class="op">=</span> <span class="st">"my_rule_combo"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"Over 3 missing values and max value is &gt; 10"</span>,</span>
<span>    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">3</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_custom</a></span><span class="op">(</span></span>
<span>    short_name <span class="op">=</span> <span class="st">"my_rule_doubled"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"Last value is over double the first value"</span>,</span>
<span>    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">value</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>expression</code> is evaluated per time series, and must
return either <code>TRUE</code> or <code>FALSE</code>. A return value of
<code>TRUE</code> means the alert result is “FAIL”</p>
<p>Column names that can be used explicitly in the expression are
<code>value</code> and <code>timepoint</code>, and which refer to the
values in the <code>value_col</code> and <code>timepoint_col</code>
columns of the data respectively. Before evaluating the
<code>expression</code>, the dataframe is grouped by the
<code>item_col</code> and ordered by the <code>timepoint_col</code>.</p>
</div>
<div class="section level2">
<h2 id="applying-different-rules-to-different-time-series">Applying different rules to different time series<a class="anchor" aria-label="anchor" href="#applying-different-rules-to-different-time-series"></a>
</h2>
<p>By default, the specified rules will be run on all time series in the
supplied dataframe. You can specify different sets of rules for
different time series by using the <code>items</code> parameter, and
providing it a named list of character vectors corresponding to the
<code>item_cols</code> columns and values that the particular rule
should be applied to.</p>
</div>
<div class="section level2">
<h2 id="walkthrough">Walkthrough<a class="anchor" aria-label="anchor" href="#walkthrough"></a>
</h2>
<p>Generate an interactive <code>mantis</code> report for the
<code>example_prescription_numbers</code> dataset supplied with the
<code>mantis</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/mantis" class="external-link">mantis</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_prescription_numbers"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mantis_report.html">mantis_report</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">example_prescription_numbers</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"example_prescription_numbers_interactive.html"</span>,</span>
<span>  inputspec <span class="op">=</span> <span class="fu"><a href="../reference/inputspec.html">inputspec</a></span><span class="op">(</span></span>
<span>    timepoint_col <span class="op">=</span> <span class="st">"PrescriptionDate"</span>,</span>
<span>    item_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Antibiotic"</span>, <span class="st">"Spectrum"</span>, <span class="st">"Location"</span><span class="op">)</span>,</span>
<span>    value_col <span class="op">=</span> <span class="st">"NumberOfPrescriptions"</span>,</span>
<span>    tab_col <span class="op">=</span> <span class="st">"Location"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  outputspec <span class="op">=</span> <span class="fu"><a href="../reference/outputspec_interactive.html">outputspec_interactive</a></span><span class="op">(</span></span>
<span>    sync_axis_range <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  report_title <span class="op">=</span> <span class="st">"mantis report"</span>,</span>
<span>  dataset_description <span class="op">=</span> <span class="st">"Antibiotic prescriptions by site"</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the SITE1 tab, the Vancomycin time series contains a block of NA
values but it is not easy to distinguish between NA values and zero
values unless you zoom in on the plot (by selecting a section of it with
the mouse) or hover the mouse over the relevant time points and read the
tooltips.</p>
<p><img src="../reference/figures/vancomycin_zoomed.png" width="100%"></p>
<p>We can easily add a rule to test for any missing values. While we’re
here, we will also add a custom rule to try to catch the fact that
Coamoxiclav prescriptions have become much higher than they were at the
start.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alert_rules.html">alert_rules</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_missing</a></span><span class="op">(</span>extent_type <span class="op">=</span> <span class="st">"any"</span>, extent_value <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_custom</a></span><span class="op">(</span></span>
<span>    short_name <span class="op">=</span> <span class="st">"my_rule_doubled"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"Last 7 values are over double the first 7 values"</span>,</span>
<span>    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new report</span></span>
<span><span class="fu"><a href="../reference/mantis_report.html">mantis_report</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">example_prescription_numbers</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"example_prescription_numbers_interactive_alerts.html"</span>,</span>
<span>  inputspec <span class="op">=</span> <span class="fu"><a href="../reference/inputspec.html">inputspec</a></span><span class="op">(</span></span>
<span>    timepoint_col <span class="op">=</span> <span class="st">"PrescriptionDate"</span>,</span>
<span>    item_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Antibiotic"</span>, <span class="st">"Spectrum"</span>, <span class="st">"Location"</span><span class="op">)</span>,</span>
<span>    value_col <span class="op">=</span> <span class="st">"NumberOfPrescriptions"</span>,</span>
<span>    tab_col <span class="op">=</span> <span class="st">"Location"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  outputspec <span class="op">=</span> <span class="fu"><a href="../reference/outputspec_interactive.html">outputspec_interactive</a></span><span class="op">(</span></span>
<span>    sync_axis_range <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  alertspec <span class="op">=</span> <span class="fu"><a href="../reference/alertspec.html">alertspec</a></span><span class="op">(</span></span>
<span>    alert_rules <span class="op">=</span> <span class="va">ars</span>,</span>
<span>    show_tab_results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FAIL"</span>, <span class="st">"NA"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  report_title <span class="op">=</span> <span class="st">"mantis report with alerts"</span>,</span>
<span>  dataset_description <span class="op">=</span> <span class="st">"Antibiotic prescriptions by site"</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The report now includes a column for the alert results, and details
can be seen by clicking on the triangles. The tab labels will include an
exclamation mark if any items in that tab have failed an alert rule.</p>
<p><img src="../reference/figures/alert_results.png" width="100%"></p>
<p>An additional tab is also created, which lists the alert results. In
this example we have decided to exclude any alerts that have passed.</p>
<p><img src="../reference/figures/alert_results_tab.png" width="100%"></p>
<p>If for some reason we only wanted to apply the custom rule to broad
spectrum antibiotics, we can indicate this using the <code>items</code>
parameter of the rule.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ars_restricted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alert_rules.html">alert_rules</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_missing</a></span><span class="op">(</span>extent_type <span class="op">=</span> <span class="st">"any"</span>, extent_value <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/alert_rule_types.html">alert_custom</a></span><span class="op">(</span></span>
<span>    short_name <span class="op">=</span> <span class="st">"my_rule_doubled"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"Last 7 values are over double the first 7 values"</span>,</span>
<span>    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Spectrum"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Broad"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new report</span></span>
<span><span class="fu"><a href="../reference/mantis_report.html">mantis_report</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">example_prescription_numbers</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"example_prescription_numbers_interactive_alerts_restricted.html"</span>,</span>
<span>  inputspec <span class="op">=</span> <span class="fu"><a href="../reference/inputspec.html">inputspec</a></span><span class="op">(</span></span>
<span>    timepoint_col <span class="op">=</span> <span class="st">"PrescriptionDate"</span>,</span>
<span>    item_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Antibiotic"</span>, <span class="st">"Spectrum"</span>, <span class="st">"Location"</span><span class="op">)</span>,</span>
<span>    value_col <span class="op">=</span> <span class="st">"NumberOfPrescriptions"</span>,</span>
<span>    tab_col <span class="op">=</span> <span class="st">"Location"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  outputspec <span class="op">=</span> <span class="fu"><a href="../reference/outputspec_interactive.html">outputspec_interactive</a></span><span class="op">(</span></span>
<span>    sync_axis_range <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  alertspec <span class="op">=</span> <span class="fu"><a href="../reference/alertspec.html">alertspec</a></span><span class="op">(</span></span>
<span>    alert_rules <span class="op">=</span> <span class="va">ars_restricted</span></span>
<span>  <span class="op">)</span>,</span>
<span>  report_title <span class="op">=</span> <span class="st">"mantis report with alerts - restricted"</span>,</span>
<span>  dataset_description <span class="op">=</span> <span class="st">"Antibiotic prescriptions by site"</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The report now shows two rules for Coamoxiclav and one rule for
Metronidazole.</p>
<p><img src="../reference/figures/alert_results_restricted.png" width="100%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by T. Phuong Quan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
